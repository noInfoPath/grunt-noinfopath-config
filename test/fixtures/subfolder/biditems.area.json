{
    "report": {
        "areas": {
            "editor": {
                "noForm": {
                    "noComponents": {
                        "bidItems": {
                            "noGrid": {
                                "referenceOnParentScopeAs": "reportBidItemValuesGrid",
                                "primaryKey": "ID",
                                "editable": true,
                                "scopeKey": "bidItems"
                            },
                            "noDataSource": {
                                "dataProvider": "noIndexedDb",
                                "databaseName": "rmEFR2",
                                "entityName": "ReportBidItemValues",
                                "primaryKey": "ID",
                                "noTransaction": {
                                    "create": [
                                        {
                                            "entityName": "ReportBidItemValues",
                                            "fields": [
                                                {
                                                    "field": "ReportID",
                                                    "value": {
                                                        "provider": "$stateParams",
                                                        "property": "id"
                                                    }
                                                }
                                            ],
                                            "actions": {
                                                "post": [
                                                    {
                                                        "provider": "bidItemService",
                                                        "method": "addReportBidItemAttributes",
                                                        "params": [
                                                            "ReportBidItemAttributes",
                                                            "ReportID",
                                                            "ReportBidItemAttribute"
                                                        ],
                                                        "noContextParams": false
                                                    }
                                                ]
                                            }
                                        }
                                    ],
                                    "update": [
                                        {
                                            "entityName": "ReportBidItemValues",
                                            "fields": [
                                                {
                                                    "field": "ReportID",
                                                    "value": {
                                                        "provider": "$stateParams",
                                                        "property": "id"
                                                    }
                                                }
                                            ]
                                        }
                                    ],
                                    "destroy": true
                                },
                                "filter": [
                                    {
                                        "field": "ReportID",
                                        "operator": "eq",
                                        "value": {
                                            "source": "$stateParams",
                                            "property": "id"
                                        }
                                    }
                                ]
                            },
                            "noKendoGrid": {
                                "selectable": {
                                    "actions": [
                                        {
                                            "provider": "noScopeHelper",
                                            "method": "setItem",
                                            "params": [
                                                {
                                                    "provider": "scope",
                                                    "property": "$parent"
                                                },
                                                "selectedBidItem",
                                                {
                                                    "provider": "noKendoHelpers",
                                                    "method": "getSelectedGridRowData",
                                                    "passElement": true
                                                }
                                            ],
                                            "noContextParams": true
                                        }
                                    ]
                                },
                                "sortable": true,
                                "pageable": {
                                    "previousNext": false,
                                    "numeric": false,
                                    "pageSize": 50,
                                    "refresh": true
                                },
                                "scrollable": {
                                    "virtual": true
                                },
                                "editable": "inline",
                                "columns": [
                                    {
                                        "field": "ProjectBidItemID.ItemNo",
                                        "title": "Item #",
                                        "format": "{0:000}",
                                        "width": "4em"
                                    },
                                    {
                                        "field": "ProjectBidItemID.MetaDataSchemaID.Title",
                                        "title": "Bid Item Type",
                                        "width": "8em",
										"template": "#: ProjectBidItemID.MetaDataSchemaID ? ProjectBidItemID.MetaDataSchemaID.Title : ''# </strong>"
                                    },
                                    {
                                        "field": "ProjectBidItemID",
                                        "title": "Bid Item",
                                        "editor": {
                                            "type": "provider",
                                            "provider": "efrReportService",
                                            "editor": "bidItems",
                                            "template": "bidItemsTemplate"
                                        }
                                    },
                                    {
                                        "field": "QTYActual",
                                        "title": "Quantity",
                                        "width": "6em"
                                    },
                                    {
                                        "field": "Notes",
                                        "title": "Notes"
                                    },
                                    {
                                        "name": "ID",
                                        "template": "<no-navigation class=\"no-flex\" no-form=\"noForm.noComponents.bidItemRowNav\"></no-navigation>",
                                        "headerTemplate": "&nbsp;",
                                        "width": "5em"
                                    }
                                ]
                            },
                            "noKendoDataSource": {
                                "pageSize": 20,
                                "schema": {
                                    "model": {
                                        "id": "ID",
                                        "fields": {
                                            "ProjectBidItemID.ItemNo": {
                                                "editable": false,
                                                "type": "number"
                                            },
											"ProjectBidItemID.MetaDataSchemaID.Title" : {
												"editable": false
											},
                                            "ProjectBidItemID": {
                                                "validation": {
                                                    "required": true
                                                }
                                            },
                                            "QTYActual": {
                                                "validation": {
                                                    "required": true,
                                                    "min": 0
                                                },
                                                "type": "number"
                                            },
                                            "Notes": {
                                                "type": "string",
                                                "validation": {
                                                    "required": false
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        },
                        "bidItemRowNav": {
                            "scopeKey": "bidItemRowNav",
                            "default": "gridRow",
                            "useKendoRowDataUid": true,
                            "watches": [],
                            "bars": {
                                "gridRow": {
                                    "class": "no-flex",
                                    "components": [
                                        {
                                            "type": "button",
                                            "actions": [
												{
													"provider": "noKendoHelpers",
			                                    	"method": "editRow",
			                                    	"params": ["reportBidItemValuesGrid", "bidItemRowNav"],
			                                    	"noContextParams": false
												}
                                            ],
                                            "class": "btn btn-default btn-xs no-m-r-sm",
                                            "icon": {
                                                "class": "fa fa-pencil"
                                            }
                                        },
                                        {
                                            "type": "button",
                                            "actions": [
                                                {
                                                    "provider": "scope",
                                                    "property": "noGrid",
                                                    "method": "removeRow",
                                                    "params": [
                                                        {
                                                            "provider": "noKendoHelpers",
                                                            "method": "getGridRow",
                                                            "passElement": true
                                                        }
                                                    ],
                                                    "noContextParams": true
                                                },
                                                {
                                                    "provider": "noKendoHelpers",
                                                    "method": "changeRowNavBar",
                                                    "params": [
                                                        "reportBidItemValuesGrid",
                                                        "bidItemRowNav",
                                                        "gridRow"
                                                    ]
                                                }
                                            ],
                                            "class": "btn btn-default btn-xs",
                                            "icon": {
                                                "class": "fa fa-trash-o"
                                            }
                                        }
                                    ]
                                },
                                "gridRow.dirty": {
                                    "class": "no-flex",
                                    "components": [
                                        {
                                            "type": "button",
                                            "actions": [
                                                {
                                                    "provider": "scope",
                                                    "property": "noGrid",
                                                    "method": "saveRow",
                                                    "params": [
                                                        {
                                                            "provider": "noKendoHelpers",
                                                            "method": "getGridRow",
                                                            "passElement": true
                                                        }
                                                    ],
                                                    "noContextParams": true
                                                }
                                            ],
                                            "class": "btn btn-default btn-xs no-m-r-sm",
                                            "icon": {
                                                "class": "fa fa-floppy-o"
                                            }
                                        },
                                        {
                                            "type": "button",
                                            "actions": [
												{
													"provider": "noKendoHelpers",
			                                    	"method": "cancelRow",
			                                    	"params": ["reportBidItemValuesGrid", "bidItemRowNav"],
			                                    	"noContextParams": false
												}
                                            ],
                                            "class": "btn btn-default btn-xs no-flex-item",
                                            "icon": {
                                                "class": "fa fa-undo"
                                            }
                                        }
                                    ]
                                }
                            }
                        },
                        "bidItemAttributes": {
                            "noGrid": {
                                "referenceOnParentScopeAs": "reportBidItemAttributes",
                                "editable": true,
                                "scopeKey": "bidItemAttributes"
                            },
                            "noDataSource": {
                                "dataProvider": "noIndexedDb",
                                "databaseName": "rmEFR2",
                                "entityName": "ReportBidItemAttributes",
                                "primaryKey": "ID",
								"noReadOptions": {
									"deepFollowRelations": true
								},
                                "noTransaction": {
                                    "update": [
                                        {
                                            "dataProvider": "noIndexedDb",
                                            "databaseName": "rmEFR2",
                                            "entityName": "ReportBidItemAttributes",
                                            "primaryKey": "ID",
                                            "objectFactory": {
                                                "provider": "efrClassFactory",
                                                "className": "ReportBidItemAttribute"
                                            },
                                            "bulk": {
                                                "ignoreDirtyFlag": false,
                                                "sourceData": {
                                                    "provider": "scope",
                                                    "property": "reportBidItemAttributes",
                                                    "method": "dataItems"
                                                }
                                            }
                                        }
                                    ]
                                },
                                "filter": [
                                    {
                                        "field": "ReportBidItemValueID",
                                        "operator": "eq",
                                        "value": {
                                            "source": "scope",
                                            "property": "selectedBidItem.ID",
                                            "watch": true
                                        }
                                    }
                                ]
                            },
                            "noKendoGrid": {
                                "editable": "incell",
                                "selectable": false,
                                "sortable": true,
                                "navigatable": true,
                                "pageable": {
                                    "previousNext": false,
                                    "numeric": false,
                                    "pageSize": 50,
                                    "refresh": false
                                },
                                "scrollable": {
                                    "virtual": true
                                },
                                "columns": [
                                    {
                                        "field": "MetaDataDefinitionID.Title",
                                        "title": "Attribute",
                                        "width": "30%"
                                    },
                                    {
                                        "field": "Value",
                                        "width": "70%",
                                        "editor": {
											"type": "provider",
											"provider": "bidItemService",
											"editor": "bidItemAttributeEditors",
											"template": "bidItemAttributeTemplate"
                                        }
                                    }
                                ]
                            },
                            "noKendoDataSource": {
                                "pageSize": 20,
                                "schema": {
                                    "model": {
                                        "id": "ID",
                                        "fields": {
                                            "MetaDataDefinitionID.Title": {
                                                "editable": false
                                            },
                                            "DateCreated": {
                                                "type": "date",
                                                "parse": "date"
                                            },
                                            "ModifiedDate": {
                                                "type": "date",
                                                "parse": "date"
                                            }
                                        }
                                    }
                                },
                                "sort": [
                                    {
                                        "field": "MetaDataDefinitionID.Title",
                                        "dir": "asc"
                                    }
                                ]
                            }
                        },
                        "addNewBidItemBtn": {
                            "actions": [
                                {
                                    "provider": "noKendoHelpers",
                                    "method": "newRow",
                                    "params": ["reportBidItemValuesGrid", "bidItemRowNav"],
                                    "noContextParams": false
                                }
                            ]
                        },
                        "mainNavBar": {
                            "bars": {
                                "biditems": "general",
                                "biditems.dirty": {
                                    "class": "no-flex justify-between no-flex-item size-1",
                                    "components": [
                                        {
                                            "type": "button",
                                            "label": "Cancel",
                                            "actions": [
                                                {
                                                    "provider": "$state",
                                                    "method": "go",
                                                    "noContextParams": true,
                                                    "params": [
                                                        "efr.project.search",
                                                        {
                                                            "provider": "noStateHelper",
                                                            "method": "makeStateParams",
                                                            "params": [
                                                                {
                                                                    "key": "id",
                                                                    "provider": "scope",
                                                                    "property": "projectBidItem.ProjectID.ID"
                                                                }
                                                            ],
                                                            "passLocalScope": true,
                                                            "passElement": true
                                                        }
                                                    ]
                                                }
                                            ],
                                            "class": "btn btn-default btn-sm",
                                            "icon": {
                                                "position": "left",
                                                "class": "fa fa-undo no-p-r-sm"
                                            }
                                        },
                                        {
                                            "type": "message",
                                            "template": "<div class=\"text-center\">Editing record. Click the Undo button to revert change, or Save to commit changes.</div>",
                                            "class": "no-flex-item size-1 text-danger"
                                        },
                                        {
                                            "type": "button",
                                            "label": "Save",
                                            "class": "btn btn-success btn-sm",
                                            "icon": {
                                                "position": "left",
                                                "class": "fa fa-floppy-o no-p-r-sm"
                                            },
                                            "actions": [
                                                {
                                                    "provider": "efrReportService",
                                                    "method": "saveBidItemAttributes",
                                                    "params": []
                                                },
												{
													"provider": "noNavigationManager",
													"method": "changeNavBar",
													"params": ["mainNavBar", "biditems"]
												}
                                            ]
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            }
        }
    }
}
